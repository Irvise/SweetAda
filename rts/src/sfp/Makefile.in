
#
# Basic units.
#

LIBGNAT_SRCS_COMMON += a-assert.ads a-assert.adb
LIBGNAT_SRCS_COMMON += a-charac.ads
LIBGNAT_SRCS_COMMON += a-chlat1.ads
LIBGNAT_SRCS_COMMON += a-except.ads a-except.adb
LIBGNAT_SRCS_COMMON += a-tags.ads   a-tags.adb
LIBGNAT_SRCS_COMMON += a-unccon.ads
LIBGNAT_SRCS_COMMON += a-uncdea.ads
LIBGNAT_SRCS_COMMON += ada.ads
LIBGNAT_SRCS_COMMON += g-souinf.ads
LIBGNAT_SRCS_COMMON += gnat.ads
LIBGNAT_SRCS_COMMON += i-c.ads      i-c.adb
LIBGNAT_SRCS_COMMON += i-cexten.ads
LIBGNAT_SRCS_COMMON += interfac.ads
LIBGNAT_SRCS_COMMON += s-assert.ads s-assert.adb
LIBGNAT_SRCS_COMMON += s-atacco.ads s-atacco.adb
LIBGNAT_SRCS_COMMON += s-exctab.ads s-exctab.adb
LIBGNAT_SRCS_COMMON += s-fatflt.ads
LIBGNAT_SRCS_COMMON += s-fatgen.ads s-fatgen.adb
LIBGNAT_SRCS_COMMON += s-fatlfl.ads
LIBGNAT_SRCS_COMMON += s-fatllf.ads
LIBGNAT_SRCS_COMMON += s-maccod.ads
LIBGNAT_SRCS_COMMON += s-multip.ads s-multip.adb
LIBGNAT_SRCS_COMMON += s-parame.ads
LIBGNAT_SRCS_COMMON += s-scaval.ads s-scaval.adb
LIBGNAT_SRCS_COMMON += s-secsta.ads s-secsta.adb
LIBGNAT_SRCS_COMMON += s-stalib.ads
LIBGNAT_SRCS_COMMON += s-stoele.ads s-stoele.adb
LIBGNAT_SRCS_COMMON += s-unstyp.ads

LIBGNARL_SRCS_COMMON += s-musplo.ads s-musplo.adb

#
# system.ads default configuration.
#
export COMMAND_LINE_ARGS         := False
export CONFIGURABLE_RUN_TIME     := True
export SUPPRESS_STANDARD_LIBRARY := True
export EXIT_STATUS_SUPPORTED     := False
export USE_ADA_MAIN_PROGRAM_NAME := False
export ZCX_BY_DEFAULT            := False

#
# s-parame.ads default configuration.
#
export SIZE_TYPE_ASPECTS              :=
export RUNTIME_DEFAULT_SEC_STACK_SIZE := 4 * 1024
export SEC_STACK_DYNAMIC              := False

#
# Makefile rules.
#

configure-rts :
ifeq      ($(OSTYPE),cmd)
	@FOR %%F IN ($(LIBGNAT_SRCS_COMMON) $(LIBGNARL_SRCS_COMMON)) DO                \
          @ECHO OFF &&                                                                 \
          IF EXIST $(RTS_SOURCE_PATH_CMD)\%%F.in (                                     \
            (                                                                          \
             $(PROCESSCFG) $(RTS_SOURCE_PATH_CMD)\%%F.in $(ADAINCLUDE_PATH_CMD)\%%F && \
             $(DOS2UNIX) $(ADAINCLUDE_PATH_CMD)\%%F $(ADAINCLUDE_PATH_CMD)\%%F         \
            ) || EXIT /B 1                                                             \
          ) ELSE (                                                                     \
            $(CP) "$(RTS_SOURCE_PATH_CMD)"\%%F "$(ADAINCLUDE_PATH_CMD)"\               \
            || EXIT /B 1                                                               \
          )
else ifeq ($(OSTYPE),msys)
	@for f in $(LIBGNAT_SRCS_COMMON) $(LIBGNARL_SRCS_COMMON) ; do         \
          (                                                                   \
           if [ -e $(RTS_SOURCE_PATH)/$$f.in ] ; then                         \
             $(PROCESSCFG) $(RTS_SOURCE_PATH)/$$f.in $(ADAINCLUDE_PATH)/$$f ; \
             $(DOS2UNIX) $(ADAINCLUDE_PATH)/$$f $(ADAINCLUDE_PATH)/$$f ;      \
           else                                                               \
             $(CP) "$(RTS_SOURCE_PATH)"/$$f "$(ADAINCLUDE_PATH)"/ ;           \
           fi                                                                 \
          ) || exit $$? ;                                                     \
        done
else
	@for f in $(LIBGNAT_SRCS_COMMON) $(LIBGNARL_SRCS_COMMON) ; do         \
          (                                                                   \
           if [ -e $(RTS_SOURCE_PATH)/$$f.in ] ; then                         \
             $(PROCESSCFG) $(RTS_SOURCE_PATH)/$$f.in $(ADAINCLUDE_PATH)/$$f ; \
           else                                                               \
             $(CP) "$(RTS_SOURCE_PATH)"/$$f "$(ADAINCLUDE_PATH)"/ ;           \
           fi                                                                 \
          ) || exit $$? ;                                                     \
        done
endif

#
# From .../gcc/ada/Makefile.rtl:
#
# Force no function reordering on a-except.o because of the exclusion bounds
# mechanism (see the source file for more detailed information).
# force debugging information on a-except.o so that it is always
# possible to set conditional breakpoints on exceptions.
# use -O1 otherwise gdb isn't able to get a full backtrace on mips targets.
#
$(ADALIB_PATH)/a-except.o : $(ADAINCLUDE_PATH)/a-except.adb
	$(ADAC) -o $@ -c -g -O1 -fno-inline -fno-toplevel-reorder $(ADAC_SWITCHES) $<

